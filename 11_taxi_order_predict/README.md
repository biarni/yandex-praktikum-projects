#  Прогнозирование заказов такси

Компания «Чётенькое такси» собрала исторические данные о заказах такси в аэропортах. Чтобы привлекать больше водителей в период пиковой нагрузки, нужно спрогнозировать количество заказов такси на следующий час. Построим модель для такого предсказания.

Значение метрики *RMSE* на тестовой выборке должно быть не больше 48.

Нам нужно:

1. Загрузить данные и выполнить их ресемплирование по одному часу.
2. Проанализировать данные.
3. Обучить разные модели с различными гиперпараметрами. Сделать тестовую выборку размером 10% от исходных данных.
4. Проверить данные на тестовой выборке и сделать выводы.


Данные лежат в файле `taxi.csv`. Количество заказов находится в столбце `num_orders` (от англ. *number of orders*, «число заказов»).

## Выводы

**Анализ данных:**
1. Тренд повышательный. Он может быть частью годовой сезонности - лето пора отпусков и люди приезжают отдохнуть, погостить или проездом. Точно не определишь (поскольку данные только за полгода).  
2. Имеющаяся в периоде сезонность обсуловлена временем суток - самое большое число заказов примерно в полночь, минимум - около 5-6 часов утра, есть утренний пик, дневной пик и дальше рост к полуночи. Поскольку речь о заказах таки из аэропортов - вероятно таковы особенности расписания рейсов. Смущает только, что расписание обычно меняется со временем.
3. Есть даты с повышенными значениями заказов. Возможно это какие-то большие мероприятия, праздники, может выбросы.  
4. Со временем есть ощущение, что остатки также несколько растут.
5. Результаты проверки статтестом Дики-Фуллера двойственные: p-value - 2,9%, что меньше 5%-порога, но больше 1%-го порога. Видимо из-за наличия повышательного тренда. Поскольку значение все же небольшое - допустим, что ряд стационарный.
6. Среднее значение заказов за один час в периоде - 84 шт., медиана - 78 шт. Пригодится для интерпретации значений метрики.

**Лучшая модель:**
CatBoost. Метрика RMSE на тестовой выборке: 41,637. Параметры:  
1. 'depth': 5, 
2. 'iterations': 920, 
3. 'learning_rate': 0.1, 
4. 'loss_function': 'RMSE'  
Метрика - чуть больше половина от среднего / медианного числа заказов в периоде.